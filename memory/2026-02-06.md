# 2026-02-06

## Git 仓库规则 (永久记住)

| 项目 | 仓库地址 | 分支 |
|------|---------|------|
| **guildadmin** | `https://github.com/TomTang13/guildadmin` | dev |
| **jws** | `https://github.com/TomTang13/jws` | win |

**问题：** workspace 根目录的 git 指向了 guildadmin 仓库，导致 jws 子目录的 git 操作受影响。

---

## 落地页邀请码功能实现

### 完成的工作

1. **加密工具** `jws/src/crypto.ts`
   - XOR 加密 + Base64 编码
   - `encrypt()` / `decrypt()` 函数
   - `isValidUUID()` 验证 UUID 格式

2. **落地页组件** `jws/components/LandingPage.tsx`
   - 支持 URL 参数 `?t=xxxx`
   - 自动解密验证 pre_users 表
   - 验证成功后自动填充昵称

3. **SQL 脚本** `jws/pre_users.sql`
   - 创建 `pre_users` 表（id UUID, nickname, is_used, used_by）
   - 插入示例数据

4. **修改的文件**
   - `jws/App.tsx` - 添加 inviteToken 状态，支持 LandingPage
   - `jws/auth.ts` - `signUp()` 增加 `preUserId` 参数
   - `jws/index.html` - 解析 `?t=` 参数并存入 sessionStorage

### 使用方式

```sql
-- Supabase SQL Editor 执行
INSERT INTO public.pre_users (id, nickname) VALUES 
  ('550e8400-e29b-41d4-a716-446655440000', '测试用户');
```

```javascript
// 生成邀请链接
import { encrypt } from './crypto';
const uuid = '550e8400-e29b-41d4-a716-446655440000';
const token = encrypt(uuid);
// 链接: https://domain.com?t=xxxxx
```

---

## 待处理

- Git 推送失败（workspace git 配置问题）
- 需要手动推送 jws 代码到 win 分支
